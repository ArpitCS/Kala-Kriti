<!DOCTYPE html>
<html lang="en">
<head>
  <title>Kala-Kriti | Admin Dashboard</title>
  <%- include('partials/base-head') %>
  <style>
    /* Admin dashboard specific styles */
    .sidebar-link.active {
      background-color: rgba(255, 255, 255, 0.1);
    }
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }
    .data-table th, .data-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }
    .data-table th {
      font-weight: 600;
      background-color: #f9fafb;
    }
    .data-table tbody tr:hover {
      background-color: #f9fafb;
    }
    .pagination-btn {
      padding: 0.5rem 0.75rem;
      border: 1px solid #e5e7eb;
      background-color: white;
      margin: 0 0.25rem;
    }
    .pagination-btn.active {
      background-color: #111827;
      color: white;
      border-color: #111827;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="flex h-screen overflow-hidden">
    <!-- Sidebar -->
    <div class="w-64 bg-gray-900 text-white flex-shrink-0 hidden md:block">
      <div class="p-6 text-center">
        <a href="/">
          <img src="/logo-white.png" alt="Kala-Kriti" class="h-12 mx-auto mb-4">
        </a>
        <div class="mt-4 mb-8">
          <img src="/uploads/profile/<%= user.profilePicture || 'default.jpg' %>" alt="Profile Picture" class="w-24 h-24 rounded-full mx-auto object-cover border-2 border-gray-700">
          <h3 class="mt-3 font-medium text-lg"><%= user.fullName || user.username %></h3>
          <p class="text-gray-400 text-sm">Administrator</p>
        </div>
        
        <div class="flex flex-col space-y-2">
          <a href="/" class="px-4 py-2 bg-gray-800 text-white rounded-md text-sm hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center">
            <i class="fa fa-home mr-2"></i>
            <span>Home</span>
          </a>
          <a href="/auth/logout" class="px-4 py-2 bg-red-600 text-white rounded-md text-sm hover:bg-red-700 transition-colors duration-200 flex items-center justify-center">
            <i class="fa fa-right-from-bracket mr-2"></i>
            <span>Logout</span>
          </a>
        </div>
      </div>
      
      <nav class="mt-2 px-4">
        <ul class="space-y-2">
          <li>
            <button onclick="showSection('overview')" class="sidebar-link w-full text-left px-4 py-2 rounded-md flex items-center text-gray-300 hover:bg-gray-800 hover:text-white transition-colors">
              <i class="fas fa-tachometer-alt w-5 mr-3"></i>
              <span>Overview</span>
            </button>
          </li>
          <li>
            <button onclick="showSection('artworks')" class="sidebar-link w-full text-left px-4 py-2 rounded-md flex items-center text-gray-300 hover:bg-gray-800 hover:text-white transition-colors">
              <i class="fas fa-palette w-5 mr-3"></i>
              <span>Artworks</span>
            </button>
          </li>
          <li>
            <button onclick="showSection('users')" class="sidebar-link w-full text-left px-4 py-2 rounded-md flex items-center text-gray-300 hover:bg-gray-800 hover:text-white transition-colors">
              <i class="fas fa-users w-5 mr-3"></i>
              <span>Users</span>
            </button>
          </li>
          <li>
            <button onclick="showSection('events')" class="sidebar-link w-full text-left px-4 py-2 rounded-md flex items-center text-gray-300 hover:bg-gray-800 hover:text-white transition-colors">
              <i class="fas fa-calendar w-5 mr-3"></i>
              <span>Events</span>
            </button>
          </li>
          <li>
            <button onclick="showSection('orders')" class="sidebar-link w-full text-left px-4 py-2 rounded-md flex items-center text-gray-300 hover:bg-gray-800 hover:text-white transition-colors">
              <i class="fas fa-shopping-cart w-5 mr-3"></i>
              <span>Orders</span>
            </button>
          </li>
        </ul>
      </nav>
    </div>
    
    <!-- Mobile sidebar toggle -->
    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 flex justify-around z-10">
      <button onclick="showSection('overview')" class="text-center">
        <i class="fas fa-tachometer-alt text-xl"></i>
        <span class="block text-xs mt-1">Overview</span>
      </button>
      <button onclick="showSection('artworks')" class="text-center">
        <i class="fas fa-palette text-xl"></i>
        <span class="block text-xs mt-1">Artworks</span>
      </button>
      <button onclick="showSection('users')" class="text-center">
        <i class="fas fa-users text-xl"></i>
        <span class="block text-xs mt-1">Users</span>
      </button>
      <button onclick="showSection('events')" class="text-center">
        <i class="fas fa-calendar text-xl"></i>
        <span class="block text-xs mt-1">Events</span>
      </button>
      <button onclick="showSection('orders')" class="text-center">
        <i class="fas fa-shopping-cart text-xl"></i>
        <span class="block text-xs mt-1">Orders</span>
      </button>
    </div>
    
    <!-- Main content -->
    <div class="flex-1 overflow-y-auto bg-gray-50">
      <!-- Dashboard header -->
      <header class="bg-white shadow-sm">
        <div class="px-6 py-4">
          <div class="flex items-center justify-between">
            <h1 class="text-2xl font-semibold text-gray-800">Admin Dashboard</h1>
            <div class="flex items-center space-x-4">
              <div class="relative">
                <input type="text" placeholder="Search..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
              </div>
              <div class="relative">
                <button class="relative p-2 rounded-full bg-gray-100 hover:bg-gray-200">
                  <i class="fas fa-bell text-gray-600"></i>
                  <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </header>
      
      <!-- Dashboard content -->
      <div class="container mx-auto px-4 py-8 pb-20 md:pb-8">
        <!-- Overview Section -->
        <div id="overview" class="section">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Stats Card - Users -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-700">Total Users</h3>
                <div class="p-2 bg-blue-100 rounded-md">
                  <i class="fas fa-users text-blue-500"></i>
                </div>
              </div>
              <div class="flex items-baseline">
                <span class="text-3xl font-bold"><%= users ? users.length : 0 %></span>
                <span class="ml-2 text-sm text-green-500 flex items-center">
                  <i class="fas fa-arrow-up mr-1"></i>12%
                </span>
              </div>
              <p class="text-sm text-gray-500 mt-2">From previous month</p>
            </div>
            
            <!-- Stats Card - Artworks -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-700">Total Artworks</h3>
                <div class="p-2 bg-purple-100 rounded-md">
                  <i class="fas fa-palette text-purple-500"></i>
                </div>
              </div>
              <div class="flex items-baseline">
                <span class="text-3xl font-bold"><%= artworks ? artworks.length : 0 %></span>
                <span class="ml-2 text-sm text-green-500 flex items-center">
                  <i class="fas fa-arrow-up mr-1"></i>8%
                </span>
              </div>
              <p class="text-sm text-gray-500 mt-2">From previous month</p>
            </div>
            
            <!-- Stats Card - Events -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-700">Total Events</h3>
                <div class="p-2 bg-yellow-100 rounded-md">
                  <i class="fas fa-calendar text-yellow-500"></i>
                </div>
              </div>
              <div class="flex items-baseline">
                <span class="text-3xl font-bold"><%= events ? events.length : 0 %></span>
                <span class="ml-2 text-sm text-red-500 flex items-center">
                  <i class="fas fa-arrow-down mr-1"></i>3%
                </span>
              </div>
              <p class="text-sm text-gray-500 mt-2">From previous month</p>
            </div>
            
            <!-- Stats Card - Orders -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-medium text-gray-700">Total Orders</h3>
                <div class="p-2 bg-green-100 rounded-md">
                  <i class="fas fa-shopping-cart text-green-500"></i>
                </div>
              </div>
              <div class="flex items-baseline">
                <span class="text-3xl font-bold"><%= orders ? orders.length : 0 %></span>
                <span class="ml-2 text-sm text-green-500 flex items-center">
                  <i class="fas fa-arrow-up mr-1"></i>24%
                </span>
              </div>
              <p class="text-sm text-gray-500 mt-2">From previous month</p>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <!-- Chart - Monthly Sales -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <h3 class="text-lg font-medium text-gray-700 mb-4">Monthly Sales</h3>
              <div class="h-72">
                <canvas id="monthlySalesChart"></canvas>
              </div>
            </div>
            
            <!-- Chart - User Growth -->
            <div class="bg-white rounded-lg shadow-sm p-6">
              <h3 class="text-lg font-medium text-gray-700 mb-4">User Growth</h3>
              <div class="h-72">
                <canvas id="userGrowthChart"></canvas>
              </div>
            </div>
          </div>
          
          <!-- Recent Activities -->
          <div class="bg-white rounded-lg shadow-sm p-6">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-700">Recent Activities</h3>
              <button class="text-sm text-blue-600 hover:text-blue-800">View All</button>
            </div>
            <div class="overflow-x-auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>User</th>
                    <th>Action</th>
                    <th>Resource</th>
                    <th>Time</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="flex items-center">
                      <img src="/uploads/profile/default.jpg" alt="User" class="w-8 h-8 rounded-full mr-3">
                      <span>John Doe</span>
                    </td>
                    <td>Created</td>
                    <td>New Artwork: "Urban Dreams"</td>
                    <td>10 min ago</td>
                  </tr>
                  <tr>
                    <td class="flex items-center">
                      <img src="/uploads/profile/default.jpg" alt="User" class="w-8 h-8 rounded-full mr-3">
                      <span>Sarah Johnson</span>
                    </td>
                    <td>Updated</td>
                    <td>Event: "Summer Exhibition"</td>
                    <td>2 hours ago</td>
                  </tr>
                  <tr>
                    <td class="flex items-center">
                      <img src="/uploads/profile/default.jpg" alt="User" class="w-8 h-8 rounded-full mr-3">
                      <span>Mike Chen</span>
                    </td>
                    <td>Purchased</td>
                    <td>Artwork: "Sunset Horizon"</td>
                    <td>4 hours ago</td>
                  </tr>
                  <tr>
                    <td class="flex items-center">
                      <img src="/uploads/profile/default.jpg" alt="User" class="w-8 h-8 rounded-full mr-3">
                      <span>Emma Wilson</span>
                    </td>
                    <td>Registered</td>
                    <td>New User</td>
                    <td>1 day ago</td>
                  </tr>
                  <tr>
                    <td class="flex items-center">
                      <img src="/uploads/profile/default.jpg" alt="User" class="w-8 h-8 rounded-full mr-3">
                      <span>David Kim</span>
                    </td>
                    <td>Updated</td>
                    <td>Profile Information</td>
                    <td>2 days ago</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <!-- Artworks Section -->
        <div id="artworks" class="section hidden">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-semibold text-gray-900">Artwork Management</h2>
            <button class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center">
              <i class="fas fa-plus mr-2"></i>
              Add New Artwork
            </button>
          </div>
          
          <!-- Filters -->
          <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <div class="flex flex-wrap gap-4 items-center">
              <div class="flex-grow">
                <input type="text" placeholder="Search artworks..." class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Categories</option>
                  <option value="painting">Painting</option>
                  <option value="sculpture">Sculpture</option>
                  <option value="photography">Photography</option>
                  <option value="digital">Digital Art</option>
                </select>
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Status</option>
                  <option value="available">Available</option>
                  <option value="sold">Sold</option>
                  <option value="reserved">Reserved</option>
                </select>
              </div>
              <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">
                <i class="fas fa-filter mr-2"></i>
                Apply Filters
              </button>
            </div>
          </div>
          
          <!-- Artwork Table -->
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Image</th>
                    <th>Title</th>
                    <th>Artist</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% if (artworks && artworks.length > 0) { %>
                    <% artworks.forEach(artwork => { %>
                      <tr>
                        <td>
                          <img src="<%= artwork.imageUrl || '/art/default.png' %>" alt="<%= artwork.title %>" class="w-16 h-16 object-cover rounded">
                        </td>
                        <td><%= artwork.title %></td>
                        <td><%= artwork.artist %></td>
                        <td><%= artwork.category %></td>
                        <td>$<%= artwork.price.toFixed(2) %></td>
                        <td>
                          <% if (artwork.status === 'available') { %>
                            <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">Available</span>
                          <% } else if (artwork.status === 'sold') { %>
                            <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium">Sold</span>
                          <% } else { %>
                            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium">Reserved</span>
                          <% } %>
                        </td>
                        <td>
                          <div class="flex space-x-2">
                            <button class="p-1 text-blue-600 hover:text-blue-800" title="Edit">
                              <i class="fas fa-edit"></i>
                            </button>
                            <button class="p-1 text-red-600 hover:text-red-800" title="Delete">
                              <i class="fas fa-trash-alt"></i>
                            </button>
                            <button class="p-1 text-gray-600 hover:text-gray-800" title="View Details">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  <% } else { %>
                    <tr>
                      <td colspan="7" class="text-center py-4">No artworks found</td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
            <div class="p-4 flex justify-between items-center border-t">
              <div class="text-sm text-gray-700">
                Showing <span class="font-medium">1</span> to <span class="font-medium">10</span> of <span class="font-medium"><%= artworks ? artworks.length : 0 %></span> results
              </div>
              <div class="flex space-x-1">
                <button class="pagination-btn" disabled>&laquo;</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <button class="pagination-btn">&raquo;</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Users Section -->
        <div id="users" class="section hidden">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-semibold text-gray-900">User Management</h2>
            <button class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center">
              <i class="fas fa-plus mr-2"></i>
              Add New User
            </button>
          </div>
          
          <!-- Filters -->
          <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <div class="flex flex-wrap gap-4 items-center">
              <div class="flex-grow">
                <input type="text" placeholder="Search users..." class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Roles</option>
                  <option value="admin">Admin</option>
                  <option value="artist">Artist</option>
                  <option value="collector">Collector</option>
                  <option value="user">User</option>
                </select>
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Status</option>
                  <option value="active">Active</option>
                  <option value="inactive">Inactive</option>
                  <option value="blocked">Blocked</option>
                </select>
              </div>
              <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">
                <i class="fas fa-filter mr-2"></i>
                Apply Filters
              </button>
            </div>
          </div>
          
          <!-- Users Table -->
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>User</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Status</th>
                    <th>Joined Date</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% if (users && users.length > 0) { %>
                    <% users.forEach(user => { %>
                      <tr>
                        <td class="flex items-center">
                          <img src="/uploads/profile/<%= user.profilePicture || 'default.jpg' %>" alt="<%= user.username %>" class="w-10 h-10 rounded-full mr-3 object-cover">
                          <div>
                            <div class="font-medium"><%= user.fullName || user.username %></div>
                            <div class="text-sm text-gray-500">@<%= user.username %></div>
                          </div>
                        </td>
                        <td><%= user.email %></td>
                        <td>
                          <span class="px-2 py-1 <%= user.role === 'admin' ? 'bg-purple-100 text-purple-800' : user.role === 'artist' ? 'bg-blue-100 text-blue-800' : 'bg-green-100 text-green-800' %> rounded-full text-xs font-medium">
                            <%= user.role.charAt(0).toUpperCase() + user.role.slice(1) %>
                          </span>
                        </td>
                        <td>
                          <% if (!user.isActive) { %>
                            <span class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium">Inactive</span>
                          <% } else { %>
                            <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">Active</span>
                          <% } %>
                        </td>
                        <td><%= new Date(user.createdAt).toLocaleDateString() %></td>
                        <td>
                          <div class="flex space-x-2">
                            <button class="p-1 text-blue-600 hover:text-blue-800" title="Edit">
                              <i class="fas fa-edit"></i>
                            </button>
                            <button class="p-1 text-red-600 hover:text-red-800" title="Delete">
                              <i class="fas fa-trash-alt"></i>
                            </button>
                            <button class="p-1 text-gray-600 hover:text-gray-800" title="View Details">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  <% } else { %>
                    <tr>
                      <td colspan="6" class="text-center py-4">No users found</td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
            <div class="p-4 flex justify-between items-center border-t">
              <div class="text-sm text-gray-700">
                Showing <span class="font-medium">1</span> to <span class="font-medium">10</span> of <span class="font-medium"><%= users ? users.length : 0 %></span> results
              </div>
              <div class="flex space-x-1">
                <button class="pagination-btn" disabled>&laquo;</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <button class="pagination-btn">&raquo;</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Events Section -->
        <div id="events" class="section hidden">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-semibold text-gray-900">Event Management</h2>
            <button class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center">
              <i class="fas fa-plus mr-2"></i>
              Create New Event
            </button>
          </div>
          
          <!-- Filters -->
          <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <div class="flex flex-wrap gap-4 items-center">
              <div class="flex-grow">
                <input type="text" placeholder="Search events..." class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Types</option>
                  <option value="exhibition">Exhibition</option>
                  <option value="workshop">Workshop</option>
                  <option value="auction">Auction</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Status</option>
                  <option value="upcoming">Upcoming</option>
                  <option value="ongoing">Ongoing</option>
                  <option value="past">Past</option>
                </select>
              </div>
              <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">
                <i class="fas fa-filter mr-2"></i>
                Apply Filters
              </button>
            </div>
          </div>
          
          <!-- Events Table -->
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Event</th>
                    <th>Type</th>
                    <th>Date</th>
                    <th>Location</th>
                    <th>Status</th>
                    <th>Attendees</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% if (events && events.length > 0) { %>
                    <% events.forEach(event => { %>
                      <tr>
                        <td>
                          <div class="flex items-center">
                            <img src="<%= event.imageUrl || '/images/event-default.jpg' %>" alt="<%= event.title %>" class="w-16 h-16 object-cover rounded mr-3">
                            <div>
                              <div class="font-medium"><%= event.title %></div>
                              <div class="text-sm text-gray-500"><%= event.description?.substring(0, 50) %>...</div>
                            </div>
                          </div>
                        </td>
                        <td><%= event.type %></td>
                        <td>
                          <div><%= new Date(event.startDate).toLocaleDateString() %></div>
                          <div class="text-sm text-gray-500"><%= new Date(event.startDate).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) %></div>
                        </td>
                        <td><%= event.location %></td>
                        <td>
                          <% 
                            const now = new Date();
                            const startDate = new Date(event.startDate);
                            const endDate = new Date(event.endDate);
                            let status = '';
                            let statusClass = '';
                            
                            if (now < startDate) {
                              status = 'Upcoming';
                              statusClass = 'bg-blue-100 text-blue-800';
                            } else if (now > endDate) {
                              status = 'Past';
                              statusClass = 'bg-gray-100 text-gray-800';
                            } else {
                              status = 'Ongoing';
                              statusClass = 'bg-green-100 text-green-800';
                            }
                          %>
                          <span class="px-2 py-1 <%= statusClass %> rounded-full text-xs font-medium"><%= status %></span>
                        </td>
                        <td><%= event.attendees?.length || 0 %> registered</td>
                        <td>
                          <div class="flex space-x-2">
                            <button class="p-1 text-blue-600 hover:text-blue-800" title="Edit">
                              <i class="fas fa-edit"></i>
                            </button>
                            <button class="p-1 text-red-600 hover:text-red-800" title="Delete">
                              <i class="fas fa-trash-alt"></i>
                            </button>
                            <button class="p-1 text-gray-600 hover:text-gray-800" title="View Details">
                              <i class="fas fa-eye"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  <% } else { %>
                    <tr>
                      <td colspan="7" class="text-center py-4">No events found</td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
            <div class="p-4 flex justify-between items-center border-t">
              <div class="text-sm text-gray-700">
                Showing <span class="font-medium">1</span> to <span class="font-medium">10</span> of <span class="font-medium"><%= events ? events.length : 0 %></span> results
              </div>
              <div class="flex space-x-1">
                <button class="pagination-btn" disabled>&laquo;</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <button class="pagination-btn">&raquo;</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Orders Section -->
        <div id="orders" class="section hidden">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-semibold text-gray-900">Order Management</h2>
            <div class="flex gap-2">
              <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors flex items-center">
                <i class="fas fa-download mr-2"></i>
                Export
              </button>
              <button class="px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center">
                <i class="fas fa-plus mr-2"></i>
                Create Order
              </button>
            </div>
          </div>
          
          <!-- Filters -->
          <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <div class="flex flex-wrap gap-4 items-center">
              <div class="flex-grow">
                <input type="text" placeholder="Search orders..." class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">All Status</option>
                  <option value="pending">Pending</option>
                  <option value="processing">Processing</option>
                  <option value="shipped">Shipped</option>
                  <option value="delivered">Delivered</option>
                  <option value="cancelled">Cancelled</option>
                </select>
              </div>
              <div class="flex-shrink-0">
                <select class="p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent">
                  <option value="">Payment Status</option>
                  <option value="paid">Paid</option>
                  <option value="unpaid">Unpaid</option>
                  <option value="refunded">Refunded</option>
                </select>
              </div>
              <button class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 transition-colors">
                <i class="fas fa-filter mr-2"></i>
                Apply Filters
              </button>
            </div>
          </div>
          
          <!-- Orders Table -->
          <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="overflow-x-auto">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Order ID</th>
                    <th>Customer</th>
                    <th>Date</th>
                    <th>Items</th>
                    <th>Total</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% if (orders && orders.length > 0) { %>
                    <% orders.forEach(order => { %>
                      <tr>
                        <td><span class="font-mono">#<%= order._id.toString().slice(-8).toUpperCase() %></span></td>
                        <td class="flex items-center">
                          <img src="/uploads/profile/<%= order.user?.profilePicture || 'default.jpg' %>" alt="User" class="w-8 h-8 rounded-full mr-3 object-cover">
                          <div>
                            <div class="font-medium"><%= order.user?.fullName || order.user?.username || 'Guest User' %></div>
                            <div class="text-sm text-gray-500"><%= order.user?.email || 'No email' %></div>
                          </div>
                        </td>
                        <td><%= new Date(order.createdAt).toLocaleDateString() %></td>
                        <td><%= order.items?.length || 0 %> item(s)</td>
                        <td><span class="font-medium">$<%= order.total?.toFixed(2) || '0.00' %></span></td>
                        <td>
                          <% 
                            let statusClass = '';
                            switch(order.status) {
                              case 'pending':
                                statusClass = 'bg-yellow-100 text-yellow-800';
                                break;
                              case 'processing':
                                statusClass = 'bg-blue-100 text-blue-800';
                                break;
                              case 'shipped':
                                statusClass = 'bg-indigo-100 text-indigo-800';
                                break;
                              case 'delivered':
                                statusClass = 'bg-green-100 text-green-800';
                                break;
                              case 'cancelled':
                                statusClass = 'bg-red-100 text-red-800';
                                break;
                              default:
                                statusClass = 'bg-gray-100 text-gray-800';
                            }
                          %>
                          <span class="px-2 py-1 <%= statusClass %> rounded-full text-xs font-medium">
                            <%= order.status.charAt(0).toUpperCase() + order.status.slice(1) %>
                          </span>
                        </td>
                        <td>
                          <div class="flex space-x-2">
                            <button class="p-1 text-blue-600 hover:text-blue-800" title="Edit">
                              <i class="fas fa-edit"></i>
                            </button>
                            <button class="p-1 text-gray-600 hover:text-gray-800" title="View Details">
                              <i class="fas fa-eye"></i>
                            </button>
                            <button class="p-1 text-green-600 hover:text-green-800" title="Invoice">
                              <i class="fas fa-file-invoice"></i>
                            </button>
                          </div>
                        </td>
                      </tr>
                    <% }); %>
                  <% } else { %>
                    <tr>
                      <td colspan="7" class="text-center py-4">No orders found</td>
                    </tr>
                  <% } %>
                </tbody>
              </table>
            </div>
            <div class="p-4 flex justify-between items-center border-t">
              <div class="text-sm text-gray-700">
                Showing <span class="font-medium">1</span> to <span class="font-medium">10</span> of <span class="font-medium"><%= orders ? orders.length : 0 %></span> results
              </div>
              <div class="flex space-x-1">
                <button class="pagination-btn" disabled>&laquo;</button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <button class="pagination-btn">&raquo;</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Include base scripts -->
  <%- include('partials/base-scripts') %>
  
  <!-- Admin Dashboard specific scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Set the default active section
      showSection('overview');
      
      // Initialize charts
      initCharts();
    });

    function showSection(sectionId) {
      // Hide all sections
      const sections = document.querySelectorAll('.section');
      sections.forEach(section => {
        section.classList.add('hidden');
      });
      
      // Show the selected section
      document.getElementById(sectionId).classList.remove('hidden');
      
      // Update active state on sidebar links
      const sidebarLinks = document.querySelectorAll('.sidebar-link');
      sidebarLinks.forEach(link => {
        link.classList.remove('active', 'bg-gray-800');
      });
      
      // Add active class to the clicked sidebar link
      const activeLink = document.querySelector(`.sidebar-link[onclick="showSection('${sectionId}')"]`);
      if (activeLink) {
        activeLink.classList.add('active', 'bg-gray-800');
      }
    }

    function initCharts() {
      // Monthly Sales Chart
      const salesCtx = document.getElementById('monthlySalesChart').getContext('2d');
      const salesChart = new Chart(salesCtx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
          datasets: [{
            label: 'Monthly Sales ($)',
            data: [5200, 4800, 6500, 7200, 8500, 9800, 9200, 10500, 11200, 10800, 12500, 14200],
            backgroundColor: 'rgba(37, 99, 235, 0.7)',
            borderColor: 'rgba(37, 99, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                display: true,
                drawBorder: true,
                color: 'rgba(200, 200, 200, 0.3)',
              }
            },
            x: {
              grid: {
                display: false,
                drawBorder: true
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'top',
            }
          }
        }
      });

      // User Growth Chart
      const userCtx = document.getElementById('userGrowthChart').getContext('2d');
      const userChart = new Chart(userCtx, {
        type: 'line',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
          datasets: [{
            label: 'Artists',
            data: [12, 19, 25, 32, 40, 45, 52, 60, 68, 74, 82, 95],
            borderColor: 'rgba(220, 38, 38, 1)',
            backgroundColor: 'rgba(220, 38, 38, 0.1)',
            tension: 0.3,
            fill: true
          }, {
            label: 'Collectors',
            data: [30, 45, 58, 76, 92, 110, 125, 142, 156, 170, 185, 204],
            borderColor: 'rgba(37, 99, 235, 1)',
            backgroundColor: 'rgba(37, 99, 235, 0.1)',
            tension: 0.3,
            fill: true
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              grid: {
                display: true,
                drawBorder: true,
                color: 'rgba(200, 200, 200, 0.3)',
              }
            },
            x: {
              grid: {
                display: false,
                drawBorder: true
              }
            }
          },
          plugins: {
            legend: {
              display: true,
              position: 'top',
            }
          }
        }
      });
    }
  </script>
</body>
</html>